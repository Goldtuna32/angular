<div class="container mx-auto mt-6 px-4">
  <div class="shadow-lg rounded-lg overflow-hidden bg-white">
    <div class="bg-blue-600 text-white p-4">
      <h4 class="text-lg font-semibold">Branch List</h4>
    </div>
    <div class="p-6">
      
      <!-- Show loading message -->
      <div *ngIf="loading" class="text-center text-gray-600">
        <p>Loading branches...</p>
      </div>

      <!-- Show error message if loading fails -->
      <div *ngIf="errorMessage" class="bg-red-500 text-white p-3 rounded mb-3">
        {{ errorMessage }}
      </div>

      <!-- Search Input -->
      <div class="mb-4">
        <input matInput (keyup)="applyFilter($event)" placeholder="Search branches..." 
          class="search-box w-full border rounded-md p-2 shadow-sm focus:ring focus:ring-blue-300">
      </div>

      <!-- Angular Material Data Table -->
      <table mat-table [dataSource]="dataSource" matSort class="mat-elevation-z8 border-collapse w-full border border-gray-200">
        
        <!-- Branch Code Column -->
        <ng-container matColumnDef="branchCode">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="border p-3 bg-gray-100">Branch Code</th>
          <td mat-cell *matCellDef="let branch" class="border p-3">{{ branch.branchCode }}</td>
        </ng-container>

        <!-- Branch Name Column -->
        <ng-container matColumnDef="branchName">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="border p-3 bg-gray-100">Branch Name</th>
          <td mat-cell *matCellDef="let branch" class="border p-3">{{ branch.branchName }}</td>
        </ng-container>

        <!-- Phone Number Column -->
        <ng-container matColumnDef="phoneNumber">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="border p-3 bg-gray-100">Phone</th>
          <td mat-cell *matCellDef="let branch" class="border p-3">{{ branch.phoneNumber }}</td>
        </ng-container>

        <!-- Email Column -->
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="border p-3 bg-gray-100">Email</th>
          <td mat-cell *matCellDef="let branch" class="border p-3">{{ branch.email }}</td>
        </ng-container>

        <!-- Address Column -->
        <ng-container matColumnDef="address">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="border p-3 bg-gray-100">Address</th>
          <td mat-cell *matCellDef="let branch" class="border p-3">
            {{ branch.region }}, {{ branch.district }}, {{ branch.township }}
          </td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
          <th mat-header-cell *matHeaderCellDef mat-sort-header class="border p-3 bg-gray-100">Status</th>
          <td mat-cell *matCellDef="let branch" class="border p-3">
            <span class="status-active" *ngIf="branch.status === 1">Active</span>
            <span class="status-inactive" *ngIf="branch.status === 0">Inactive</span>
          </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef class="border p-3 bg-gray-100">Actions</th>
          <td mat-cell *matCellDef="let branch" class="border p-3 flex gap-2">
            
            <!-- Edit Button -->
            <button class="bg-blue-500 text-white px-3 py-1 rounded hover:bg-blue-700" 
                    matTooltip="Edit Branch" (click)="editBranch(branch.id)">
              <i class="bi bi-pencil"></i> Edit
            </button>            

            <!-- Delete Button -->
            <button class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-700"
                    matTooltip="Delete Branch" (click)="deleteBranch(branch.id)">
              <i class="bi bi-trash"></i> Delete
            </button>

            <!-- View Details Button -->
            <button class="bg-teal-500 text-white px-3 py-1 rounded hover:bg-teal-700"
                    matTooltip="View Details" (click)="viewDetails(branch.id)">
              <i class="bi bi-eye"></i> View
            </button>

          </td>
        </ng-container>

        <!-- Header and Row Definitions -->
        <tr mat-header-row *matHeaderRowDef="displayedColumns" class="bg-gray-100"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
      </table>

      <!-- Paginator -->
      <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
    </div>
  </div>
</div>
